<idea-plugin>
    <id>org.xtclang.idea</id>
    <name>XTC Language Support</name>
    <vendor email="info@xtclang.org" url="https://xtclang.org">XTC Language</vendor>

    <description><![CDATA[
        XTC (Ecstasy) language support for IntelliJ IDEA.

        Features:
        <ul>
            <li>New Project wizard for XTC projects</li>
            <li>Run configurations for XTC applications</li>
            <li>Syntax highlighting for .x files</li>
            <li>Language features via LSP (hover, completion, go-to-definition)</li>
        </ul>

        Requirements:
        <ul>
            <li>XDK installed with XDK_HOME environment variable set, OR</li>
            <li>The LSP server JAR bundled with the plugin</li>
        </ul>
    ]]></description>

    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.modules.java</depends>
    <depends>com.intellij.gradle</depends>
    <!-- TextMate plugin for syntax highlighting -->
    <depends>org.jetbrains.plugins.textmate</depends>
    <!-- LSP4IJ provides LSP support for Community Edition -->
    <depends>com.redhat.devtools.lsp4ij</depends>

    <extensions defaultExtensionNs="com.intellij">
        <!-- Notification group for LSP status messages -->
        <notificationGroup id="XTC Language Server"
                           displayType="BALLOON"
                           isLogByDefault="true"/>

        <!-- Project Generator for New Project wizard (IntelliJ IDEA) -->
        <newProjectWizard.generator
            implementation="org.xtclang.idea.project.XtcNewProjectWizard"/>

        <!-- Run Configuration -->
        <configurationType
            implementation="org.xtclang.idea.run.XtcRunConfigurationType"/>

        <!-- Run Configuration Producer - auto-creates run configs from .x file context -->
        <runConfigurationProducer
            implementation="org.xtclang.idea.run.XtcRunConfigurationProducer"/>

        <!-- IconProvider for .x files - provides icon without overriding TextMate highlighting -->
        <iconProvider implementation="org.xtclang.idea.XtcIconProvider"/>
    </extensions>

    <!-- LSP4IJ Language Server registration -->
    <extensions defaultExtensionNs="com.redhat.devtools.lsp4ij">
        <server id="xtcLanguageServer"
                name="XTC Language Server"
                factoryClass="org.xtclang.idea.lsp.XtcLanguageServerFactory">
            <description><![CDATA[
                Provides language features for XTC (Ecstasy) files via LSP.
                Requires XDK_HOME to be set or the LSP server JAR to be bundled.
            ]]></description>
        </server>
        <fileNamePatternMapping patterns="*.x"
                                 serverId="xtcLanguageServer"/>

        <!-- DAP (Debug Adapter Protocol) server registration -->
        <debugAdapterServer id="xtcDebugAdapter"
                            name="XTC Debug Adapter"
                            factoryClass="org.xtclang.idea.dap.XtcDebugAdapterFactory"/>
    </extensions>

    <!-- TextMate grammar for syntax highlighting (via IntelliJ's TextMate plugin) -->
    <extensions defaultExtensionNs="com.intellij">
        <textmate.bundleProvider
            implementation="org.xtclang.idea.XtcTextMateBundleProvider"/>
    </extensions>
</idea-plugin>
