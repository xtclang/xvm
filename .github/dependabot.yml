# Dependabot configuration for dependabot inspections for the repo on GitHub.

version: 2

# ============================================================================
# YAML Anchors - Reusable configuration snippets
# ============================================================================
x-weekly-schedule: &weekly-schedule
    interval: "weekly"
    day: "saturday"
    time: "06:00"

updates:
    # Enable version updates for GitHub Actions
    - package-ecosystem: "github-actions"
      directory: "/"
      schedule:
          <<: *weekly-schedule
      open-pull-requests-limit: 5
      commit-message:
          prefix: "ci"
          include: "scope"

    # Enable version updates for Docker
    - package-ecosystem: "docker"
      directory: "/docker"
      schedule:
          <<: *weekly-schedule
      open-pull-requests-limit: 5
      commit-message:
          prefix: "docker"
          include: "scope"

    # Enable version updates for Gradle dependencies
    #
    # NOTE: Ignore org.xtclang.* dependencies as they use
    # dynamic version resolution from version.properties.
    #
    - package-ecosystem: "gradle"
      directory: "/"
      schedule:
          <<: *weekly-schedule
      open-pull-requests-limit: 3
      groups:
          # Group all dependency updates into a single PR
          gradle-dependencies:
              patterns:
                  - "*"
      commit-message:
          prefix: "deps"
          include: "scope"
      ignore:
          # Ignore XDK internal dependencies
          # (use dynamic versioning)
          - dependency-name: "org.xtclang.*"
          # Ignore major and minor updates (too risky, require manual review)
          # Only allow patch updates
          - dependency-name: "*"
            update-types: ["version-update:semver-major", "version-update:semver-minor"]
            # But allow security updates even for major/minor
            # (GitHub automatically overrides this for security updates)
